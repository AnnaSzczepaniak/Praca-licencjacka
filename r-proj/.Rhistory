givens(G)
givens = function(i,j,A){
dimm = dim(A)
n = dimm[1]
G = diag(n)
return(G)
}
#cos_(x) = a_ii/ sqrt((a_ii)^2 + (a_ji)^2)
givens = function(i,j,A){
dimm = dim(A)
n = dimm[1]
G = diag(n)
G[i:n,i:n] = A  %*% G[i:n,i:n]
return(G)
}
#cos_(x) = a_ii/ sqrt((a_ii)^2 + (a_ji)^2)
A <- matrix(c(2,-2,18,2,1,0,1,2,0), 3, 3, byrow=TRUE)
A
givens = function(i,j,A){
dimm = dim(A)
n = dimm[1]
G = diag(n)
G[i:n,i:n] = A  %*% G[i:n,i:n]
return(G)
}
#cos_(x) = a_ii/ sqrt((a_ii)^2 + (a_ji)^2)
givens = function(i,j,A){
dimm = dim(A)
n = dimm[1]
G = diag(n)
G[i:n,i:n] = A  %*% G[i:n,i:n]
return(G)
}
givens(1,2,diag(3))
#cos_(x) = a_ii/ sqrt((a_ii)^2 + (a_ji)^2)
givens = function(i,j,A){
dimm = dim(A)
n = dimm[1]
G = diag(n)
G[i:n,i:n] = A  %*% G[i:n,i:n]
return(G)
}
givens(1,2,magic(7))
?magic
givens = function(i,j,A){
dimm = dim(A)
n = dimm[1]
G = diag(n)
G[i:n,i:n] = A  %*% G[i:n,i:n]
return(G)
}
A= matrix(c(1,2,3,4,5,6,7,8,9), 4,4, byrow = TRUE)
givens(1,2,A)
#cos_(x) = a_ii/ sqrt((a_ii)^2 + (a_ji)^2)
givens = function(i,j,A){
dimm = dim(A)
n = dimm[1]
G = diag(n)
%G[i:n,i:n] = A  %*% G[i:n,i:n]
givens = function(i,j,A){
dimm = dim(A)
n = dimm[1]
G = diag(n)
#G[i:n,i:n] = A  %*% G[i:n,i:n]
return(G)
}
A= matrix(c(1,2,3,4,5,6,7,8,9), 4,4, byrow = TRUE)
givens(1,2,A)
#cos_(x) = a_ii/ sqrt((a_ii)^2 + (a_ji)^2)
givens = function(i,j,A){
dimm = dim(A)
n = dimm[1]
G = diag(n)
G[i,i] = c
G[i,j] = -s
G[j,i] = s
G[j,j] = c
return(G)
}
A= matrix(c(1,2,3,4,5,6,7,8,9), 4,4, byrow = TRUE)
givens(1,2,A)
givens = function(i,j,A){
dimm = dim(A)
n = dimm[1]
G = diag(n)
p = sqrt((A[i,i])^2 + (A[j,i])^2)
G[i,i] = A[i,i] %*% 1/ p
G[i,j] = -(A[j,i]) %*% 1/p
G[j,i] = (A[j,i]) %*% 1/p
G[j,j] = A[i,i] %*% 1/ p
return(G)
}
A= matrix(c(1,2,3,4,5,6,7,8,9), 4,4, byrow = TRUE)
givens(1,2,A)
#cos_(x) = a_ii/ sqrt((a_ii)^2 + (a_ji)^2)
givens = function(i,j,A){
dimm = dim(A)
n = dimm[1]
G = diag(n)
p = sqrt((A[i,i])^2 + (A[j,i])^2)
G[i,i] = A[i,i] %*% 1/ p
G[i,j] = -(A[j,i]) %*% 1/p
G[j,i] = (A[j,i]) %*% 1/p
G[j,j] = A[i,i] %*% 1/ p
return(G)
}
A= matrix(c(1,2,3,4,5,6,7,8,9), 4,4, byrow = TRUE)
givens(1,3,A)
#cos_(x) = a_ii/ sqrt((a_ii)^2 + (a_ji)^2)
qr_givens = function(A){
R = A
for (i in 1:n) {
for (j in (i+1:n)) {
G = givens(i,j,A)
R = G %*% R
}
}
return(R)
}
qr_givens(A)
qr_givens = function(A){
R = A
n = dim(A)[2]
m = dim(A)[1]
for (i in 1:n) {
for (j in (i+1):m) {
G = givens(i,j,A)
R = G %*% R
}
}
return(R)
}
qr_givens(A)
qr_givens = function(A){
R = A
n = dim(A)[2]
m = dim(A)[1]
for (i in 1:(n-1)) {
for (j in (i+1):m) {
G = givens(i,j,A)
R = G %*% R
}
}
return(R)
}
qr_givens(A)
?reverse
5:1
qr_givens = function(A){
R = A
n = dim(A)[2]
m = dim(A)[1]
for (i in 1:(n-1)) {
for (j in m:(i+1)) {
G = givens(i,j,A)
R = G %*% R
}
}
return(R)
}
qr_givens(A)
qr_givens = function(A){
R = A
n = dim(A)[2]
m = dim(A)[1]
for (i in 1:(n-1)) {
for (j in m:(i+1)) {
G = givens(i,j,A)
print(R)
R = G %*% R
}
}
return(R)
}
qr_givens(A)
givens = function(i,j,A){
dimm = dim(A)
n = dimm[1]
G = diag(n)
p = sqrt((A[i,i])^2 + (A[j,i])^2)
G[i,i] = A[i,i] %*% 1/ p
G[i,j] = -(A[j,i]) %*% 1/p
G[j,i] = (A[j,i]) %*% 1/p
G[j,j] = A[i,i] %*% 1/ p
return(G)
}
A= matrix(c(1,2,3,4,5,6,7,8,9,10,11,12,13,14,15), 4,4, byrow = TRUE)
givens(1,3,A)
#cos_(x) = a_ii/ sqrt((a_ii)^2 + (a_ji)^2)
givens = function(i,j,A){
dimm = dim(A)
n = dimm[1]
G = diag(n)
p = sqrt((A[i,i])^2 + (A[j,i])^2)
G[i,i] = A[i,i]/ p
G[i,j] = -(A[j,i])/p
G[j,i] = (A[j,i])/p
G[j,j] = A[i,i]/ p
return(G)
}
A= matrix(c(1,2,3,4,5,6,7,8,9,10,11,12,13,14,15), 4,4, byrow = TRUE)
givens(1,3,A)
#cos_(x) = a_ii/ sqrt((a_ii)^2 + (a_ji)^2)
givens(1,3,A) %*% A
givens(1,4,A) %*% A
givens(1,4,A)
givens = function(i,j,A){
dimm = dim(A)
n = dimm[1]
G = diag(n)
p = sqrt((A[i,i])^2 + (A[j,i])^2)
G[i,i] = A[i,i]/ p
G[i,j] = (A[j,i])/p
G[j,i] = -(A[j,i])/p
G[j,j] = A[i,i]/ p
return(G)
}
A= matrix(c(1,2,3,4,5,6,7,8,9,10,11,12,13,14,15), 4,4, byrow = TRUE)
givens(1,3,A)
#cos_(x) = a_ii/ sqrt((a_ii)^2 + (a_ji)^2)
givens(1,4,A) %*% A
givens(1,3,A) %*% A
qr_givens = function(A){
R = A
n = dim(A)[2]
m = dim(A)[1]
for (i in 1:(n-1)) {
for (j in m:(i+1)) {
G = givens(i,j,A)
print(R)
R = G %*% R
}
}
return(R)
}
qr_givens(A)
qr_givens = function(A){
R = A
n = dim(A)[2]
m = dim(A)[1]
for (i in 1:(n-1)) {
for (j in (i+1):m) {
G = givens(i,j,A)
print(R)
R = G %*% R
}
}
return(R)
}
qr_givens(A)
qr_givens = function(A){
R = A
n = dim(A)[2]
m = dim(A)[1]
for (i in 1:(n-1)) {
for (j in m:(i+1)) {
G = givens(i,j,A)
print(R)
R = G %*% R
}
}
return(R)
}
qr_givens(A)
qr_givens = function(A){
R = A
n = dim(A)[2]
m = dim(A)[1]
for (i in 1:(n-1)) {
for (j in m:(i+1)) {
G = givens(i,j,A)
print(c(i,j))
print(R)
print(G)
R = G %*% R
}
}
return(R)
}
qr_givens(A)
givens = function(i,j,A){
dimm = dim(A)
n = dimm[1]
G = diag(n)
p = sqrt((A[i,i])^2 + (A[j,i])^2)
G[i,i] = A[i,i]/ p
G[i,j] = (A[j,i])/p
G[j,i] = -(A[j,i])/p
G[j,j] = A[i,i]/ p
return(G)
}
A= matrix(c(1,2,3,1,3,4,1,3,3), 3,3, byrow = TRUE)
givens(1,3,A)
#cos_(x) = a_ii/ sqrt((a_ii)^2 + (a_ji)^2)
givens = function(i,j,A){
dimm = dim(A)
n = dimm[1]
G = diag(n)
p = sqrt((A[i,i])^2 + (A[j,i])^2)
G[i,i] = A[i,i]/ p
G[i,j] = (A[j,i])/p
G[j,i] = -(A[j,i])/p
G[j,j] = A[i,i]/ p
return(G)
}
A= matrix(c(1,2,3,1,3,4,1,3,3), 3,3, byrow = TRUE)
givens(3,1,A)
#cos_(x) = a_ii/ sqrt((a_ii)^2 + (a_ji)^2)
givens = function(i,j,A){
dimm = dim(A)
n = dimm[1]
G = diag(n)
p = sqrt((A[i,i])^2 + (A[j,i])^2)
G[i,i] = A[i,i]/ p
G[i,j] = (A[j,i])/p
G[j,i] = -(A[j,i])/p
G[j,j] = A[i,i]/ p
return(G)
}
A= matrix(c(1,2,2,2,2,1,2,1,2), 3,3, byrow = TRUE)
givens(3,1,A)
#cos_(x) = a_ii/ sqrt((a_ii)^2 + (a_ji)^2)
givens = function(i,j,A){
dimm = dim(A)
n = dimm[1]
G = diag(n)
p = sqrt((A[i,i])^2 + (A[j,i])^2)
G[i,i] = A[i,i]/ p
G[i,j] = (A[j,i])/p
G[j,i] = -(A[j,i])/p
G[j,j] = A[i,i]/ p
return(G)
}
A= matrix(c(1,2,2,2,2,1,2,1,2), 3,3, byrow = TRUE)
givens(3,1,A)
#cos_(x) = a_ii/ sqrt((a_ii)^2 + (a_ji)^2)
givens = function(i,j,A){
dimm = dim(A)
n = dimm[1]
G = diag(n)
p = sqrt((A[i,i])^2 + (A[j,i])^2)
G[i,i] = A[i,i]/ p
G[i,j] = (A[j,i])/p
G[j,i] = -(A[j,i])/p
G[j,j] = A[i,i]/ p
return(G)
}
A= matrix(c(1,2,2,2,2,1,2,1,2), 3,3, byrow = TRUE)
givens(3,1,A)
#cos_(x) = a_ii/ sqrt((a_ii)^2 + (a_ji)^2)
givens(1,3,A) %*% A
givens = function(i,j,A){
dimm = dim(A)
n = dimm[1]
G = diag(n)
p = sqrt((A[i,i])^2 + (A[j,i])^2)
G[i,i] = A[i,i]/ p
G[i,j] = (A[j,i])/p
G[j,i] = -(A[j,i])/p
G[j,j] = A[i,i]/ p
return(G)
}
A= matrix(c(1,2,2,2,2,1,2,1,2), 3,3, byrow = TRUE)
A
givens(3,1,A)
givens = function(i,j,A){
dimm = dim(A)
n = dimm[1]
G = diag(n)
p = sqrt((A[i,i])^2 + (A[j,i])^2)
G[i,i] = A[i,i]/ p
G[i,j] = (A[j,i])/p
G[j,i] = -(A[j,i])/p
G[j,j] = A[i,i]/ p
return(G)
}
A= matrix(c(1,2,2,2,2,1,2,1,2), 3,3, byrow = TRUE)
A
givens(1,2,A)
1/sqrt(5)
2/sqrt(5)
givens(3,1,A) %*% A
qr_givens = function(A){
R = A
n = dim(A)[2]
m = dim(A)[1]
for (i in 1:(n-1)) {
for (j in m:(i+1)) {
G = givens(j,i,A)
print(c(i,j))
print(R)
print(G)
R = G %*% R
}
}
return(R)
}
qr_givens(A)
givens = function(i,j,A){
dimm = dim(A)
n = dimm[1]
G = diag(n)
p = sqrt((A[i,i])^2 + (A[j,i])^2)
G[i,i] = A[i,i]/ p
G[i,j] = (A[j,i])/p
G[j,i] = -(A[j,i])/p
G[j,j] = A[i,i]/ p
return(G)
}
A= matrix(c(1,2,2,2,2,1,2,1,2), 3,3, byrow = TRUE)
A
givens(1,2,A)
givens = function(i,j,A){
dimm = dim(A)
n = dimm[1]
G = diag(n)
p = sqrt((A[i,i])^2 + (A[j,i])^2)
G[i,i] = A[i,i]/ p
G[i,j] = (A[j,i])/p
G[j,i] = -(A[j,i])/p
G[j,j] = A[i,i]/ p
return(G)
}
A= matrix(c(1,2,2,2,2,1,2,1,2), 3,3, byrow = TRUE)
A
G = givens(1,2,A)
G
G %*% A
5/ sqrt(5)
6 / sqrt(5)
4/sqrt(5)
-3 / sqrt(5)
givens = function(i,j,A){
dimm = dim(A)
n = dimm[1]
G = diag(n)
p = sqrt((A[i,i])^2 + (A[j,i])^2)
G[i,i] = A[i,i]/ p
G[i,j] = (A[j,i])/p
G[j,i] = -(A[j,i])/p
G[j,j] = A[i,i]/ p
return(G)
}
A= matrix(c(1,2,2,2,2,1,2,1,2), 3,3, byrow = TRUE)
A
G = givens(1,2,A)
G
A2= G %*% A
A2
G = givens(1,3,A2)
A3 = G%*% A2
A3
qr_givens = function(A){
R = A
n = dim(A)[2]
m = dim(A)[1]
for (i in 1:(n-1)) {
for (j in m:(i+1)) {
G = givens(j,i,R)
print(c(i,j))
print(R)
print(G)
R = G %*% R
}
}
return(R)
}
qr_givens(A)
qr_givens = function(A){
R = A
n = dim(A)[2]
m = dim(A)[1]
for (i in 1:(n-1)) {
for (j in (i+1):m) {
G = givens(j,i,R)
print(c(i,j))
print(R)
print(G)
R = G %*% R
}
}
return(R)
}
qr_givens(A)
qr_givens = function(A){
R = A
n = dim(A)[2]
m = dim(A)[1]
for (i in 1:(n-1)) {
for (j in (i+1):m) {
G = givens(i,j,R)
R = G %*% R
}
}
return(R)
}
qr_givens(A)
qr_givens = function(A){
R = A
n = dim(A)[2]
m = dim(A)[1]
Q = diag(n)
for (i in 1:(n-1)) {
for (j in (i+1):m) {
G = givens(i,j,R)
R = G %*% R
Q = Q %*% t(G)
}
}
return(list(R=R, Q=Q))
}
qr_givens(A)
