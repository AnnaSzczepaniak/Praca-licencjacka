qr_householer(A)
qr.Q(qr(A))
givens = function(i,j,A){
dimm = dim(A)
n = dimm[1]
G = diag(n)
p = sqrt((A[i,i])^2 + (A[j,i])^2)
G[i,i] = A[i,i]/ p
G[i,j] = (A[j,i])/p
G[j,i] = -(A[j,i])/p
G[j,j] = A[i,i]/ p
return(G)
}
A= matrix(c(1,2,2,2,2,1,2,1,2), 3,3, byrow = TRUE)
A
G = givens(1,2,A)
G
A2= G %*% A
A2
G = givens(1,3,A2)
A3 = G%*% A2
A3
givens(3,1,A) %*% A
qr_givens = function(A){
R = A
n = dim(A)[2]
m = dim(A)[1]
Q = diag(n)
for (i in 1:(n-1)) {
for (j in (i+1):m) {
G = givens(i,j,R)
R = G %*% R
Q = Q %*% t(G)
}
}
return(list(R=R, Q=Q))
}
qr_givens(A)
M_1<-matrix(c(replicate(5, rnorm(5)) ), 5, 5, byrow=TRUE)
M_1
QR = qr(M_1)
qr.Q(QR)
qr.R(QR)
qr_givens(M_1)
qr_householer(M_1)
wynik = qr_householer(M_1)
wynik = qr_householer(M_1)
wynik$R
wynik = qr_householer(M_1)
wynik$Q
qr(M_1)
knitr::opts_chunk$set(echo = TRUE)
A <- matrix(c(2,-2,18,2,1,0,1,2,0), 3, 3, byrow=TRUE)
A
house = function(x) {
norm_x = sqrt(t(x) %*% x)
if (x[1] > 0) {
x[1] = x[1] + norm_x;
} else {
x[1] = x[1] - norm_x;
}
return(x)
}
qr_householer = function(A)
{
R = A
dimm = dim(A)
n = dimm[2]
m = dimm[1]
Q = diag(n)
for (i in 1:min(m-1,n)){
u = house(R[i:m,i])
den =  (t(u) %*% u)[1,1]
P = diag(n+1-i) - 2/den * ( u%*% t(u)  )
R[i:m,i:n] = P %*% R[i:m,i:n]
if (i>1)
Q[i:n,1:(i-1)] = P %*% Q[i:n,1:(i-1)]
Q[i:n,i:n] = P %*% Q[i:n,i:n]
}
return(list(R=R, Q=t(Q)))
}
qr_householer(A)
qr.Q(qr(A))
givens = function(i,j,A){
dimm = dim(A)
n = dimm[1]
G = diag(n)
p = sqrt((A[i,i])^2 + (A[j,i])^2)
G[i,i] = A[i,i]/ p
G[i,j] = (A[j,i])/p
G[j,i] = -(A[j,i])/p
G[j,j] = A[i,i]/ p
return(G)
}
A= matrix(c(1,2,2,2,2,1,2,1,2), 3,3, byrow = TRUE)
A
G = givens(1,2,A)
G
A2= G %*% A
A2
G = givens(1,3,A2)
A3 = G%*% A2
A3
givens(3,1,A) %*% A
qr_givens = function(A){
R = A
n = dim(A)[2]
m = dim(A)[1]
Q = diag(n)
for (i in 1:(n-1)) {
for (j in (i+1):m) {
G = givens(i,j,R)
R = G %*% R
Q = Q %*% t(G)
}
}
return(list(R=R, Q=Q))
}
qr_givens(A)
M_1<-matrix(c(replicate(5, rnorm(5)) ), 5, 5, byrow=TRUE)
M_1
QR = qr(M_1)
qr.Q(QR)
qr.R(QR)
qr_givens(M_1)
wynik1_householder = qr_householer(M_1)
wynik1_householder$Q
wynik1_householder$R
wynik1_givens = qr(M_1)
wynik1_givens$Q
wynik1_givens$R
wynik1_givens = qr(M_1)
wynik1_givens$Q
wynik1_givens$R
knitr::opts_chunk$set(echo = TRUE)
A <- matrix(c(2,-2,18,2,1,0,1,2,0), 3, 3, byrow=TRUE)
A
house = function(x) {
norm_x = sqrt(t(x) %*% x)
if (x[1] > 0) {
x[1] = x[1] + norm_x;
} else {
x[1] = x[1] - norm_x;
}
return(x)
}
qr_householer = function(A)
{
R = A
dimm = dim(A)
n = dimm[2]
m = dimm[1]
Q = diag(n)
for (i in 1:min(m-1,n)){
u = house(R[i:m,i])
den =  (t(u) %*% u)[1,1]
P = diag(n+1-i) - 2/den * ( u%*% t(u)  )
R[i:m,i:n] = P %*% R[i:m,i:n]
if (i>1)
Q[i:n,1:(i-1)] = P %*% Q[i:n,1:(i-1)]
Q[i:n,i:n] = P %*% Q[i:n,i:n]
}
return(list(R=R, Q=t(Q)))
}
qr_householer(A)
qr.Q(qr(A))
givens = function(i,j,A){
dimm = dim(A)
n = dimm[1]
G = diag(n)
p = sqrt((A[i,i])^2 + (A[j,i])^2)
G[i,i] = A[i,i]/ p
G[i,j] = (A[j,i])/p
G[j,i] = -(A[j,i])/p
G[j,j] = A[i,i]/ p
return(G)
}
A= matrix(c(1,2,2,2,2,1,2,1,2), 3,3, byrow = TRUE)
A
G = givens(1,2,A)
G
A2= G %*% A
A2
G = givens(1,3,A2)
A3 = G%*% A2
A3
givens(3,1,A) %*% A
qr_givens = function(A){
R = A
n = dim(A)[2]
m = dim(A)[1]
Q = diag(n)
for (i in 1:(n-1)) {
for (j in (i+1):m) {
G = givens(i,j,R)
R = G %*% R
Q = Q %*% t(G)
}
}
return(list(R=R, Q=Q))
}
qr_givens(A)
M_1<-matrix(c(replicate(5, rnorm(5)) ), 5, 5, byrow=TRUE)
M_1
QR = qr(M_1)
qr.Q(QR)
qr.R(QR)
wynik1_givens = qr_givens(M_1)
wynik1_givens$Q
wynik1_givens$R
wynik1_householder = qr_householer(M_1)
wynik1_householder$Q
wynik1_householder$R
M_1_givens = wynik1_givens$Q  %*%wynik1_givens$R
M_11 = M_1_givens^2 - M_1^2
blad_givens_M_1 = sqrt(M_11)
M_1_qr = qr.Q(QR) %*% qr.R(QR)
M_12 = M_1_qr - M_1
blad_qr_M_1 = sqrt(M_12)
M_1_householder = wynik1_householer$Q %*% wynik1_householer$R
M_1_givens = wynik1_givens$Q  %*%wynik1_givens$R
M_11 = M_1_givens^2 - M_1^2
blad_givens_M_1 = sqrt(M_11)
M_1_qr = qr.Q(QR) %*% qr.R(QR)
M_12 = M_1_qr - M_1
blad_qr_M_1 = sqrt(M_12)
M_1_householder = wynik1_householder$Q %*% wynik1_householder$R
M_13 = M_1_householder^2 - M_1^2
blad_householder_M_1 = sqrt(M_13)
M_1_givens = wynik1_givens$Q  %*%wynik1_givens$R
M_11 = M_1_givens^2 - M_1^2
blad_givens_M_1 = sqrt(M_11)
M_1_qr = qr.Q(QR) %*% qr.R(QR)
M_12 = M_1_qr - M_1
blad_qr_M_1 = sqrt(M_12)
M_1_householder = wynik1_householder$Q %*% wynik1_householder$R
M_13 = M_1_householder^2 - M_1^2
blad_householder_M_1 = sqrt(M_13)
blad_givens_M_1
blad_householder_M_1
blad_qr_M_1
M_1_givens = wynik1_givens$Q  %*% wynik1_givens$R
M_11 = M_1_givens^2 - M_1^2
blad_givens_M_1 = sqrt(M_11)
M_1_qr = qr.Q(QR) %*% qr.R(QR)
M_12 = M_1_qr - M_1
blad_qr_M_1 = sqrt(M_12)
M_1_householder = wynik1_householder$Q %*% wynik1_householder$R
M_13 = M_1_householder^2 - M_1^2
blad_householder_M_1 = sqrt(M_13)
blad_givens_M_1
blad_householder_M_1
blad_qr_M_1
M_3<-matrix(c(replicate(125, rnorm(125)) ), 125, 125, byrow=TRUE)
M_3<-matrix(c(replicate(125, rnorm(125)) ), 125, 125, byrow=TRUE)
QR = qr(M_3)
qr.Q(QR)
qr.R(QR)
wynik3_givens = qr_givens(M_3)
wynik3_givens$Q
wynik3_givens$R
wynik3_householder = qr_householer(M_3)
wynik3_householder$Q
wynik3_householder$R
M_3_givens = wynik3_givens$Q  %*% wynik3_givens$R
M_31 = M_3_givens^2 - M_3^2
blad_givens_M_3 = sqrt(M_31)
M_3_qr = qr.Q(QR) %*% qr.R(QR)
M_32 = M_3_qr - M_3
blad_qr_M_3 = sqrt(M_32)
M_3_householder = wynik3_householder$Q %*% wynik3_householder$R
M_33 = M_3_householder^2 - M_3^2
blad_householder_M_3 = sqrt(M_33)
blad_givens_M_3
blad_householder_M_3
blad_qr_M_3
?norm
knitr::opts_chunk$set(echo = TRUE)
M_1_givens = wynik1_givens$Q  %*% wynik1_givens$R
M_11 = M_1_givens - M_1
blad_givens_M_1 = norm(M_11)
blad_givens_M_1
knitr::opts_chunk$set(echo = TRUE)
A <- matrix(c(2,-2,18,2,1,0,1,2,0), 3, 3, byrow=TRUE)
A
house = function(x) {
norm_x = sqrt(t(x) %*% x)
if (x[1] > 0) {
x[1] = x[1] + norm_x;
} else {
x[1] = x[1] - norm_x;
}
return(x)
}
qr_householer = function(A)
{
R = A
dimm = dim(A)
n = dimm[2]
m = dimm[1]
Q = diag(n)
for (i in 1:min(m-1,n)){
u = house(R[i:m,i])
den =  (t(u) %*% u)[1,1]
P = diag(n+1-i) - 2/den * ( u%*% t(u)  )
R[i:m,i:n] = P %*% R[i:m,i:n]
if (i>1)
Q[i:n,1:(i-1)] = P %*% Q[i:n,1:(i-1)]
Q[i:n,i:n] = P %*% Q[i:n,i:n]
}
return(list(R=R, Q=t(Q)))
}
qr_householer(A)
qr.Q(qr(A))
givens = function(i,j,A){
dimm = dim(A)
n = dimm[1]
G = diag(n)
p = sqrt((A[i,i])^2 + (A[j,i])^2)
G[i,i] = A[i,i]/ p
G[i,j] = (A[j,i])/p
G[j,i] = -(A[j,i])/p
G[j,j] = A[i,i]/ p
return(G)
}
A= matrix(c(1,2,2,2,2,1,2,1,2), 3,3, byrow = TRUE)
A
G = givens(1,2,A)
G
A2= G %*% A
A2
G = givens(1,3,A2)
A3 = G%*% A2
A3
givens(3,1,A) %*% A
qr_givens = function(A){
R = A
n = dim(A)[2]
m = dim(A)[1]
Q = diag(n)
for (i in 1:(n-1)) {
for (j in (i+1):m) {
G = givens(i,j,R)
R = G %*% R
Q = Q %*% t(G)
}
}
return(list(R=R, Q=Q))
}
qr_givens(A)
M_1<-matrix(c(replicate(5, rnorm(5)) ), 5, 5, byrow=TRUE)
M_1
QR = qr(M_1)
qr.Q(QR)
qr.R(QR)
wynik1_givens = qr_givens(M_1)
wynik1_givens$Q
wynik1_givens$R
wynik1_householder = qr_householer(M_1)
wynik1_householder$Q
wynik1_householder$R
M_1_givens = wynik1_givens$Q  %*% wynik1_givens$R
M_11 = M_1_givens - M_1
blad_givens_M_1 = norm(M_11)
blad_givens_M_1
M_1_qr = qr.Q(QR) %*% qr.R(QR)
M_12 = M_1_qr - M_1
blad_qr_M_1 = norm(M_12)
blad_qr_M_1
M_1_householder = wynik1_householder$Q %*% wynik1_householder$R
M_13 = M_1_householder - M_1
blad_householder_M_1 = norm(M_13)
blad_householder_M_1
min(blad_givens_M_1, blad_householder_M_1, blad_qr_M_1)
max(blad_givens_M_1, blad_householder_M_1, blad_qr_M_1)
knitr::opts_chunk$set(echo = TRUE)
A <- matrix(c(2,-2,18,2,1,0,1,2,0), 3, 3, byrow=TRUE)
A
house = function(x) {
norm_x = sqrt(t(x) %*% x)
if (x[1] > 0) {
x[1] = x[1] + norm_x;
} else {
x[1] = x[1] - norm_x;
}
return(x)
}
qr_householer = function(A)
{
R = A
dimm = dim(A)
n = dimm[2]
m = dimm[1]
Q = diag(n)
for (i in 1:min(m-1,n)){
u = house(R[i:m,i])
den =  (t(u) %*% u)[1,1]
P = diag(n+1-i) - 2/den * ( u%*% t(u)  )
R[i:m,i:n] = P %*% R[i:m,i:n]
if (i>1)
Q[i:n,1:(i-1)] = P %*% Q[i:n,1:(i-1)]
Q[i:n,i:n] = P %*% Q[i:n,i:n]
}
return(list(R=R, Q=t(Q)))
}
qr_householer(A)
qr.Q(qr(A))
givens = function(i,j,A){
dimm = dim(A)
n = dimm[1]
G = diag(n)
p = sqrt((A[i,i])^2 + (A[j,i])^2)
G[i,i] = A[i,i]/ p
G[i,j] = (A[j,i])/p
G[j,i] = -(A[j,i])/p
G[j,j] = A[i,i]/ p
return(G)
}
A= matrix(c(1,2,2,2,2,1,2,1,2), 3,3, byrow = TRUE)
A
G = givens(1,2,A)
G
A2= G %*% A
A2
G = givens(1,3,A2)
A3 = G%*% A2
A3
givens(3,1,A) %*% A
qr_givens = function(A){
R = A
n = dim(A)[2]
m = dim(A)[1]
Q = diag(n)
for (i in 1:(n-1)) {
for (j in (i+1):m) {
G = givens(i,j,R)
R = G %*% R
Q = Q %*% t(G)
}
}
return(list(R=R, Q=Q))
}
qr_givens(A)
M_1<-matrix(c(replicate(5, rnorm(5)) ), 5, 5, byrow=TRUE)
M_1
QR = qr(M_1)
qr.Q(QR)
qr.R(QR)
wynik1_givens = qr_givens(M_1)
wynik1_givens$Q
wynik1_givens$R
wynik1_householder = qr_householer(M_1)
wynik1_householder$Q
wynik1_householder$R
M_1_givens = wynik1_givens$Q  %*% wynik1_givens$R
M_11 = M_1_givens - M_1
blad_givens_M_1 = norm(M_11)
blad_givens_M_1
M_1_qr = qr.Q(QR) %*% qr.R(QR)
M_12 = M_1_qr - M_1
blad_qr_M_1 = norm(M_12)
blad_qr_M_1
M_1_householder = wynik1_householder$Q %*% wynik1_householder$R
M_13 = M_1_householder - M_1
blad_householder_M_1 = norm(M_13)
blad_householder_M_1
min(blad_givens_M_1, blad_householder_M_1, blad_qr_M_1)
max(blad_givens_M_1, blad_householder_M_1, blad_qr_M_1)
M_2<-matrix(c(replicate(25, rnorm(25)) ), 25, 25, byrow=TRUE)
QR = qr(M_2)
qr.Q(QR)
qr.R(QR)
wynik2_givens = qr_givens(M_2)
wynik2_givens$Q
wynik2_givens$R
wynik2_householder = qr_householer(M_2)
wynik2_householder$Q
wynik2_householder$R
M_2_givens = wynik2_givens$Q  %*% wynik2_givens$R
M_21 = M_2_givens - M_2
blad_givens_M_2 = norm(M_21)
blad_givens_M_2
M_2_qr = qr.Q(QR) %*% qr.R(QR)
M_22 = M_2_qr - M_2
blad_qr_M_2 = norm(M_22)
blad_qr_M_2
M_2_householder = wynik2_householder$Q %*% wynik2_householder$R
M_23 = M_2_householder - M_2
blad_householder_M_2 = norm(M_23)
blad_householder_M_2
M_3<-matrix(c(replicate(125, rnorm(125)) ), 125, 125, byrow=TRUE)
QR = qr(M_3)
qr.Q(QR)
qr.R(QR)
wynik3_givens = qr_givens(M_3)
wynik3_givens$Q
wynik3_givens$R
wynik3_householder = qr_householer(M_3)
wynik3_householder$Q
wynik3_householder$R
M_3_givens = wynik3_givens$Q  %*% wynik3_givens$R
M_31 = M_3_givens - M_3
blad_givens_M_3 = norm(M_31)
blad_givens_M_3
M_3_qr = qr.Q(QR) %*% qr.R(QR)
M_32 = M_3_qr - M_3
blad_qr_M_3 = norm(M_32)
blad_qr_M_3
M_3_householder = wynik3_householder$Q %*% wynik3_householder$R
M_33 = M_3_householder - M_3
blad_householder_M_3 = norm(M_33)
blad_householder_M_3
